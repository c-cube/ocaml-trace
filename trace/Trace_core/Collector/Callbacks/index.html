<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Callbacks (trace.Trace_core.Collector.Callbacks)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">Index</a> &#x00BB; <a href="../../../index.html">trace</a> &#x00BB; <a href="../../index.html">Trace_core</a> &#x00BB; <a href="../index.html">Collector</a> &#x00BB; Callbacks</nav><header class="odoc-preamble"><h1>Module <code><span>Collector.Callbacks</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'st t</span></span><span> = </span><span>{</span></code><ol><li id="type-t.enter_span" class="def record field anchored"><a href="#type-t.enter_span" class="anchor"></a><code><span>enter_span : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">__FUNCTION__</span>:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">__FILE__</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">__LINE__</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data</span>:
    <span><span>(string
     * <span>[ <span>`Int of int</span>
       <span><span>| `String</span> of string</span>
       <span><span>| `Bool</span> of bool</span>
       <span><span>| `Float</span> of float</span>
       <span>| `None</span> ]</span>)</span>
      list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">parent</span>:<span class="xref-unresolved">Trace_core__.Types.parent</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Trace_core__.Types.span</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Enter a span</p><span class="comment-delim">*)</span></div></li><li id="type-t.exit_span" class="def record field anchored"><a href="#type-t.exit_span" class="anchor"></a><code><span>exit_span : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Trace_core__.Types.span</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Exit a span. Must be called exactly once per span. Additional constraints on nesting, threads, etc. vary per collector.</p><span class="comment-delim">*)</span></div></li><li id="type-t.add_data_to_span" class="def record field anchored"><a href="#type-t.add_data_to_span" class="anchor"></a><code><span>add_data_to_span : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Trace_core__.Types.span</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string
   * <span>[ <span>`Int of int</span>
     <span><span>| `String</span> of string</span>
     <span><span>| `Bool</span> of bool</span>
     <span><span>| `Float</span> of float</span>
     <span>| `None</span> ]</span>)</span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  unit;</span></code></li><li id="type-t.enabled" class="def record field anchored"><a href="#type-t.enabled" class="anchor"></a><code><span>enabled : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Is the collector accepting spans/messages/metrics with this level?</p><span class="comment-delim">*)</span></div></li><li id="type-t.message" class="def record field anchored"><a href="#type-t.message" class="anchor"></a><code><span>message : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data</span>:
    <span><span>(string
     * <span>[ <span>`Int of int</span>
       <span><span>| `String</span> of string</span>
       <span><span>| `Bool</span> of bool</span>
       <span><span>| `Float</span> of float</span>
       <span>| `None</span> ]</span>)</span>
      list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">span</span>:<span><span class="xref-unresolved">Trace_core__.Types.span</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Emit a message or log</p><span class="comment-delim">*)</span></div></li><li id="type-t.metric" class="def record field anchored"><a href="#type-t.metric" class="anchor"></a><code><span>metric : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">data</span>:
    <span><span>(string
     * <span>[ <span>`Int of int</span>
       <span><span>| `String</span> of string</span>
       <span><span>| `Bool</span> of bool</span>
       <span><span>| `Float</span> of float</span>
       <span>| `None</span> ]</span>)</span>
      list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Trace_core__.Types.metric</span> <span class="arrow">&#45;&gt;</span></span>
  unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Metric .</p><span class="comment-delim">*)</span></div></li><li id="type-t.extension" class="def record field anchored"><a href="#type-t.extension" class="anchor"></a><code><span>extension : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Trace_core__.Types.extension_event</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Collector-specific extension. It now has a level as well.</p><span class="comment-delim">*)</span></div></li><li id="type-t.init" class="def record field anchored"><a href="#type-t.init" class="anchor"></a><code><span>init : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Called on initialization</p><span class="comment-delim">*)</span></div></li><li id="type-t.shutdown" class="def record field anchored"><a href="#type-t.shutdown" class="anchor"></a><code><span>shutdown : <span><span class="type-var">'st</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Shutdown collector, possibly waiting for it to finish sending data.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Callbacks taking a state <code>'st</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : 
  <span><span class="optlabel">?enabled</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">enter_span</span>:
    <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">__FUNCTION__</span>:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">__FILE__</span>:string <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">__LINE__</span>:int <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">data</span>:
        <span><span>(string
         * <span>[ <span>`Int of int</span>
           <span><span>| `String</span> of string</span>
           <span><span>| `Bool</span> of bool</span>
           <span><span>| `Float</span> of float</span>
           <span>| `None</span> ]</span>)</span>
          list</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">parent</span>:<span class="xref-unresolved">Trace_core__.Types.parent</span> <span class="arrow">&#45;&gt;</span></span>
      <span>string <span class="arrow">&#45;&gt;</span></span>
      <span class="xref-unresolved">Trace_core__.Types.span</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">exit_span</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Trace_core__.Types.span</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">add_data_to_span</span>:
    <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="xref-unresolved">Trace_core__.Types.span</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span><span>(string
       * <span>[ <span>`Int of int</span>
         <span><span>| `String</span> of string</span>
         <span><span>| `Bool</span> of bool</span>
         <span><span>| `Float</span> of float</span>
         <span>| `None</span> ]</span>)</span>
        list</span> <span class="arrow">&#45;&gt;</span></span>
      unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">message</span>:
    <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">data</span>:
        <span><span>(string
         * <span>[ <span>`Int of int</span>
           <span><span>| `String</span> of string</span>
           <span><span>| `Bool</span> of bool</span>
           <span><span>| `Float</span> of float</span>
           <span>| `None</span> ]</span>)</span>
          list</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">span</span>:<span><span class="xref-unresolved">Trace_core__.Types.span</span> option</span> <span class="arrow">&#45;&gt;</span></span>
      <span>string <span class="arrow">&#45;&gt;</span></span>
      unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">metric</span>:
    <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">params</span>:<span><span class="xref-unresolved">Trace_core__.Types.extension_parameter</span> list</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="label">data</span>:
        <span><span>(string
         * <span>[ <span>`Int of int</span>
           <span><span>| `String</span> of string</span>
           <span><span>| `Bool</span> of bool</span>
           <span><span>| `Float</span> of float</span>
           <span>| `None</span> ]</span>)</span>
          list</span> <span class="arrow">&#45;&gt;</span></span>
      <span>string <span class="arrow">&#45;&gt;</span></span>
      <span><span class="xref-unresolved">Trace_core__.Types.metric</span> <span class="arrow">&#45;&gt;</span></span>
      unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?extension</span>:
    <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">level</span>:<a href="../../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Trace_core__.Types.extension_event</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?init</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?shutdown</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Helper to create backends in a future-proof way</p></div></div></div></body></html>
